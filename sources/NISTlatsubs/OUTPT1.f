      SUBROUTINE OUTPT1(IFLAG1)
      COMMON /CELLI/ AI,BI,CI,ALPI,BETI,GAMI,VOLI
      COMMON /CELLF/ AF,BF,CF,ALPF,BETF,GAMF,VOLF
      COMMON /CNTR1/ ICNTR1
      COMMON /DELTA1/ IRSS
      COMMON /DELTA3/ IDET,ILATNO
      COMMON /DOTP/ S11,S22,S33,S23,S13,S12
      COMMON /INVER1/ UI1,VI1,WI1,UI2,VI2,WI2,UI3,VI3,WI3
      COMMON /MATR1/ U1,V1,W1,U2,V2,W2,U3,V3,W3
      COMMON /PRINT1/ IPRRSS
      COMMON /PROB1/ NTD,IPROB
      COMMON /UNIT2/ IUNITB
C**
      COMMON /CK02/ ICK021,ICK022,ICK023,ICK024,ICK025,ICK026,ICK027,
     $              ICK028,ICK029
C*
C
C
C     SUBROUTINE 'OUTPT1' ...
C          OUTPUT FOR PROGRAM
C
C
C
C**
C     --- WHEN NOT EXECUTING SPECIAL CHECK RUN, GO TO SECTION
C         OF CODE FOR NORMAL EXECUTION OF PROGRAM
      IF(ICK029.NE.1) GO TO 5
C
C        --- WRITE PROBLEM NUMBER IF INDICATED
         IF(IFLAG1.EQ.3) CALL CKPT02(13)
         GO TO 900
    5 CONTINUE
C*
C
C     --- RETURN IF NO REDUCTION AND DERIVATIVE LATTICE OUTPUT
      IF(IPRRSS.EQ.1.AND.IFLAG1.GT.2) GO TO 900
C
C     --- GO TO APPROPRIATE SECTION OF OUTPUT (INDICATED BY IFLAG1)
      GO TO (10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170)
     $ IFLAG1
   10 CONTINUE
C
C     *** CALLED FROM 'LATTIC'
C
C     --- WRITE NUMBER OF INDEPENDENT PROBLEMS TO STUDY
      WRITE(IUNITB,1100)
      WRITE(IUNITB,1200) NTD
      GO TO 900
   20 CONTINUE
C
C     --- INVALID VALUE OF IFLAG1 GENERATED, STOP PROGRAM
C         EXECUTION (SHOULD NOT OCCUR)
      STOP '*OUTPT1* ERROR ... Invalid value of IFLAG1 generated.'
   30 CONTINUE
C
C     *** CALLED FROM 'REDUCE'
C
C     --- WRITE PROBLEM NUMBER
      IF(IPROB.NE.1) WRITE(IUNITB,9000)
      WRITE(IUNITB,1300) IPROB
      GO TO 900
   40 CONTINUE
C
C     *** CALLED FROM 'RD021'
C
C     --- HEADINGS FOR RSS SPECIFICATIONS
      IF(IRSS.EQ.0) WRITE(IUNITB,1400)
      IF(IRSS.EQ.1) WRITE(IUNITB,1500)
      IF(IRSS.EQ.2) WRITE(IUNITB,1600)
      IF(IRSS.EQ.3) WRITE(IUNITB,1700)
      GO TO 900
   50 CONTINUE
C
C     *** CALLED FROM 'RD021'
C
C     --- HEADING FOR CENTERING OF INPUT CELL
      IF(ICNTR1.EQ.0.OR.ICNTR1.EQ.1) WRITE(IUNITB,1800)
      IF(ICNTR1.EQ.2) WRITE(IUNITB,1900)
      IF(ICNTR1.EQ.3) WRITE(IUNITB,2000)
      IF(ICNTR1.EQ.4) WRITE(IUNITB,2100)
      IF(ICNTR1.EQ.5) WRITE(IUNITB,2200)
      IF(ICNTR1.EQ.6) WRITE(IUNITB,2300)
      IF(ICNTR1.EQ.7) WRITE(IUNITB,2400)
      GO TO 900
   60 CONTINUE
C
C     --- INVALID VALUE OF IFLAG1 GENERATED, STOP PROGRAM
C         EXECUTION (SHOULD NOT OCCUR)
      STOP '*OUTPT1* ERROR ... Invalid value of IFLAG1 generated.'
   70 CONTINUE
C
C     *** CALLED FROM 'DERIV'
C
C     --- HEADING FOR SUPERLATTICES
      WRITE(IUNITB,2500) IDET
      GO TO 900
   80 CONTINUE
C
C     *** CALLED FROM 'DERIV'
C
C     --- HEADING FOR SUBLATTICES
      WRITE(IUNITB,2600) IDET
      GO TO 900
   90 CONTINUE
C
C     *** CALLED FROM 'DERIV'
C
C     --- WRITE LATTICE NUMBER IF SUPERCELL OR SUBCELL
      IF(IRSS.EQ.1.OR.IRSS.EQ.3) WRITE(IUNITB,2700) ILATNO
      IF(IRSS.EQ.2) WRITE(IUNITB,2800) ILATNO
      GO TO 900
  100 CONTINUE
C
C     *** CALLED FROM 'CENTER' OR 'DERIV'
C
C     --- WRITE TRANSFORMATION MATRIX
      WRITE(IUNITB,2900) U1, V1, W1, U2, V2, W2, U3, V3, W3
      GO TO 900
  110 CONTINUE
C
C     *** CALLED FROM 'TRANS'
C
C     --- WRITE TRANSFORMATION MATRIX
      WRITE(IUNITB,3000) U1, V1, W1, U2, V2, W2, U3, V3, W3
      GO TO 900
  120 CONTINUE
C
C     *** CALLED FROM 'INVERS'
C
C     --- WRITE INVERSE MATRIX
      WRITE(IUNITB,3100) UI1, VI1, WI1, UI2, VI2, WI2,
     $      UI3, VI3, WI3
      GO TO 900
  130 CONTINUE
C
C     *** CALLED FROM 'TRANS'
C
C     --- HEADING FOR CELL MATRIX
      WRITE(IUNITB,3200)
C
C     --- WRITE INITIAL CELL, FINAL CELL AND CELL MATRIX
      WRITE(IUNITB,3300) AI, BI, CI, ALPI, BETI, GAMI, VOLI,
     $      S11, S22, S33
      WRITE(IUNITB,3400) AF, BF, CF, ALPF, BETF, GAMF, VOLF,
     $      S23, S13, S12
      GO TO 900
  140 CONTINUE
C
C     *** CALLED FROM 'LATTIC'
C
C     --- HEADING FOR CELL TRANSFORMATION
      WRITE(IUNITB,3500)
      GO TO 900
  150 CONTINUE
C
C     *** CALLED FROM 'LATTIC'
C
C     --- SUB-HEADING FOR CELL TRANSFORMATION
      WRITE(IUNITB,3600) IPROB
      GO TO 900
  160 CONTINUE
C
C     *** CALLED FROM 'LATTIC'
C
C     --- HEADING FOR MATRIX INVERSION
      WRITE(IUNITB,3700)
      GO TO 900
  170 CONTINUE
C
C     *** CALLED FROM 'LATTIC'
C
C     --- SUB-HEADING FOR MATRIX INVERSION
      WRITE(IUNITB,3800) IPROB
C
  900 CONTINUE
      RETURN
 1100 FORMAT(////1X,10X,'REDUCTION AND DERIVATIVE LATTICE'///)
 1200 FORMAT(2X,'Number of independent problems to study = ',I2//)
 1300 FORMAT(////10X,I3,'.  ')
 1400 FORMAT(1H+,16X,'REDUCTION'/)
 1500 FORMAT(1H+,16X,'SUPERLATTICES'/)
 1600 FORMAT(1H+,16X,'SUBLATTICES'/)
 1700 FORMAT(1H+,16X,'SUPERLATTICES for a given delta followed by SUBLAT
     $TICES for 1/delta'/)
 1800 FORMAT(//33X,'** Initial Cell is Primitive **'/)
 1900 FORMAT(//33X,'** Initial Cell is A-Centered **'/)
 2000 FORMAT(//33X,'** Initial Cell is B-Centered **'/)
 2100 FORMAT(//33X,'** Initial Cell is C-Centered **'/)
 2200 FORMAT(//33X,'** Initial Cell is F-Centered **'/)
 2300 FORMAT(//33X,'** Initial Cell is I-Centered **'/)
 2400 FORMAT(//32X,'** Initial Cell is RH-Centered **'/)
 2500 FORMAT(///2X,'Superlattices for Delta = ',I2)
 2600 FORMAT(///2X,'Sublattices for Delta = 1/',I2)
 2700 FORMAT(//36X,'***** Supercell ',I3,' *****'/)
 2800 FORMAT(//37X,'***** Subcell ',I3,' *****'/)
C     Minor formatting change by Brian Toby 10/29/2022: increase sig. digits
C       for cell reduction matrix display
C 2900 FORMAT(1X,'T 1=',4X,3F7.2,'/',3F7.2,'/',3F7.2)
C 3000 FORMAT(1X,'T 2=',4X,3F7.2,'/',3F7.2,'/',3F7.2)
C 3100 FORMAT(1X,'T 2 INV=',3F7.2,'/',3F7.2,'/',3F7.2)
 2900 FORMAT(1X,'T 1=',4X,3F14.7,'/',3F14.7,'/',3F14.7)
 3000 FORMAT(1X,'T 2=',4X,3F14.7,'/',3F14.7,'/',3F14.7)
 3100 FORMAT(1X,'T 2 INV=',3F14.7,'/',3F14.7,'/',3F14.7)
 3200 FORMAT(1H+,108X,'** Cell Matrix **'/)
 3300 FORMAT(1X,'CELL  1=',3F10.4,1X,3F10.3,14X,'V1=',F10.2,5X,3F10.3)
 3400 FORMAT(1X,'CELL  2=',3F10.4,1X,3F10.3,14X,'V2=',F10.2,5X,3F10.3)
 3500 FORMAT(////1X,10X,'CELL TRANSFORMATION'/)
 3600 FORMAT(//33X,'** Cell Transformation ',I2,' **'/)
 3700 FORMAT(////1X,10X,'MATRIX INVERSION'/)
 3800 FORMAT(//33X,'** Matrix Inversion ',I2,' **'/)
 9000 FORMAT(1H1)
      END
